{"version":3,"file":"browser.esm.js","sources":["../../../node_modules/tslib/tslib.es6.js","../src/browserOptions.ts","../src/browserTransport.ts","../src/browserClient.ts","../src/utils.ts","../src/plugins/xhr.ts","../src/plugins/fetch.ts","../src/plugins/dom.ts","../src/plugins/error.ts","../src/plugins/hashRoute.ts","../src/plugins/historyRoute.ts","../src/plugins/console.ts","../src/plugins/unhandlerejecttion.ts","../src/index.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { BaseOptions } from '@mitojs/core'\nimport { ToStringTypes } from '@mitojs/shared'\nimport { validateOptionsAndSet } from '@mitojs/utils'\nimport { BrowserOptionsFieldsTypes } from './types'\n\nexport class BrowserOptions extends BaseOptions<BrowserOptionsFieldsTypes> {\n  /**\n   * 静默监控xhr事件\n   */\n  silentXhr: boolean\n  /**\n   * 静默监控fetch事件\n   */\n  silentFetch: boolean\n  /**\n   * 静默监控console事件\n   */\n  silentConsole: boolean\n  /**\n   * 静默监控Dom事件\n   */\n  silentDom: boolean\n  /**\n   * 静默监控history事件\n   */\n  silentHistory: boolean\n  /**\n   * 静默监控error事件\n   */\n  silentError: boolean\n  /**\n   * 静默监控unhandledrejection事件\n   */\n  silentUnhandledrejection: boolean\n  /**\n   * 静默监控hashchange事件\n   */\n  silentHashchange: boolean\n  useImgUpload: boolean\n  configReportXhr: unknown = null\n  constructor(options: BrowserOptionsFieldsTypes) {\n    super()\n    super.bindOptions(options)\n    this.bindOptions(options)\n  }\n  bindOptions(options: BrowserOptionsFieldsTypes) {\n    const {\n      silentXhr,\n      silentFetch,\n      silentConsole,\n      silentDom,\n      silentHistory,\n      silentError,\n      silentHashchange,\n      silentUnhandledrejection,\n      useImgUpload,\n      configReportXhr\n    } = options\n    const booleanType = ToStringTypes.Boolean\n    const optionArr = [\n      [silentXhr, 'silentXhr', booleanType],\n      [silentFetch, 'silentFetch', booleanType],\n      [silentConsole, 'silentConsole', booleanType],\n      [silentDom, 'silentDom', booleanType],\n      [silentHistory, 'silentHistory', booleanType],\n      [silentError, 'silentError', booleanType],\n      [silentHashchange, 'silentHashchange', booleanType],\n      [silentUnhandledrejection, 'silentUnhandledrejection', booleanType],\n      [useImgUpload, 'useImgUpload', booleanType],\n      [configReportXhr, 'configReportXhr', ToStringTypes.Function]\n    ]\n    validateOptionsAndSet.call(this, optionArr)\n  }\n}\n","import { MethodTypes, ToStringTypes } from '@mitojs/shared'\nimport { BrowserOptionsFieldsTypes } from './types'\nimport { safeStringify, toStringValidateOption } from '@mitojs/utils'\nimport { ReportDataType } from '@mitojs/types'\nimport { BaseTransport } from '@mitojs/core'\n\nexport class BrowserTransport extends BaseTransport<BrowserOptionsFieldsTypes> {\n  configReportXhr: unknown\n  useImgUpload = false\n  constructor(options: BrowserOptionsFieldsTypes = {}) {\n    super()\n    super.bindOptions(options)\n    this.bindOptions(options)\n  }\n  post(data: any, url: string) {\n    const requestFun = (): void => {\n      const xhr = new XMLHttpRequest()\n      xhr.open(MethodTypes.Post, url)\n      xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8')\n      xhr.withCredentials = true\n      if (typeof this.configReportXhr === 'function') {\n        this.configReportXhr(xhr, data)\n      }\n      xhr.send(safeStringify(data))\n    }\n    this.queue.addTask(requestFun)\n  }\n  imgRequest(data: any, url: string): void {\n    const requestFun = () => {\n      let img = new Image()\n      const spliceStr = url.indexOf('?') === -1 ? '?' : '&'\n      img.src = `${url}${spliceStr}data=${encodeURIComponent(safeStringify(data))}`\n      img = null\n    }\n    this.queue.addTask(requestFun)\n  }\n  sendToServer(data: any, url: string) {\n    return this.useImgUpload ? this.imgRequest(data, url) : this.post(data, url)\n  }\n  getTransportData(data: ReportDataType) {\n    return {\n      authInfo: this.getAuthInfo(),\n      data\n    }\n  }\n  bindOptions(options: BrowserOptionsFieldsTypes = {}) {\n    const { configReportXhr, useImgUpload } = options\n    toStringValidateOption(configReportXhr, 'configReportXhr', ToStringTypes.Function) && (this.configReportXhr = configReportXhr)\n    toStringValidateOption(useImgUpload, 'useImgUpload', ToStringTypes.Boolean) && (this.useImgUpload = useImgUpload)\n  }\n}\n","import { Breadcrumb, BaseClient } from '@mitojs/core'\nimport {\n  BrowserBreadcrumbTypes,\n  BrowserEventTypes,\n  ErrorTypes,\n  EventTypes,\n  MitoLog,\n  MitoLogEmptyMsg,\n  MitoLogEmptyTag,\n  Silent\n} from '@mitojs/shared'\nimport {\n  extractErrorStack,\n  firstStrtoUppercase,\n  getBreadcrumbCategoryInBrowser,\n  getLocationHref,\n  getTimestamp,\n  isError,\n  Severity,\n  unknownToString\n} from '@mitojs/utils'\nimport { LogTypes } from '@mitojs/types'\nimport { BrowserOptions } from './browserOptions'\nimport { BrowserTransport } from './browserTransport'\nimport { BrowserOptionsFieldsTypes } from './types'\n\nexport class BrowserClient extends BaseClient<BrowserOptionsFieldsTypes, EventTypes> {\n  transport: BrowserTransport\n  options: BrowserOptions\n  breadcrumb: Breadcrumb<BrowserOptionsFieldsTypes>\n  constructor(options: BrowserOptionsFieldsTypes = {}) {\n    super(options)\n    this.options = new BrowserOptions(options)\n    this.transport = new BrowserTransport(options)\n    this.breadcrumb = new Breadcrumb(options)\n  }\n  /**\n   * 判断当前插件是否启用，用于browser的option\n   *\n   * @param {BrowserEventTypes} name\n   * @return {*}\n   * @memberof BrowserClient\n   */\n  isPluginEnable(name: BrowserEventTypes): boolean {\n    const silentField = `${Silent}${firstStrtoUppercase(name)}`\n    return !this.options[silentField]\n  }\n  log(data: LogTypes) {\n    const { message = MitoLogEmptyMsg, tag = MitoLogEmptyTag, level = Severity.Critical, ex = '' } = data\n    let errorInfo = {}\n    if (isError(ex)) {\n      errorInfo = extractErrorStack(ex, level)\n    }\n    const error = {\n      type: ErrorTypes.LOG,\n      level,\n      message: unknownToString(message),\n      name: MitoLog,\n      customTag: unknownToString(tag),\n      time: getTimestamp(),\n      url: getLocationHref(),\n      ...errorInfo\n    }\n    const breadcrumbStack = this.breadcrumb.push({\n      type: BrowserBreadcrumbTypes.CUSTOMER,\n      category: getBreadcrumbCategoryInBrowser(BrowserBreadcrumbTypes.CUSTOMER),\n      data: message,\n      level: Severity.fromString(level.toString())\n    })\n    this.transport.send(error, breadcrumbStack)\n  }\n}\n","import { BrowserBreadcrumbTypes } from '@mitojs/shared'\nimport { getBreadcrumbCategoryInBrowser, Severity } from '@mitojs/utils'\nimport { BrowserClient } from './browserClient'\n\nexport function addBreadcrumbInBrowser(\n  this: BrowserClient,\n  data: any,\n  type: BrowserBreadcrumbTypes,\n  level = Severity.Info,\n  params: any = {}\n) {\n  return this.breadcrumb.push({\n    type,\n    data,\n    category: getBreadcrumbCategoryInBrowser(type),\n    level,\n    ...params\n  })\n}\n","import { BREADCRUMBCATEGORYS, BrowserBreadcrumbTypes, BrowserEventTypes, ErrorTypes, globalVar, HttpTypes, HTTP_CODE } from '@mitojs/shared'\nimport {\n  getTimestamp,\n  replaceOld,\n  Severity,\n  _global,\n  variableTypeDetection,\n  on,\n  fromHttpStatus,\n  SpanStatus,\n  getLocationHref,\n  getRealPath\n} from '@mitojs/utils'\nimport { BasePluginType, HttpCollectedType, HttpTransformedType, MITOXMLHttpRequest, voidFun } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\n\nconst xhrPlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.XHR,\n  monitor(notify) {\n    monitorXhr.call(this, notify)\n  },\n  transform(collectedData: HttpCollectedType) {\n    return httpTransform(collectedData)\n  },\n  consumer(transformedData: HttpTransformedType) {\n    httpTransformedDataConsumer.call(this, transformedData)\n  }\n}\n\nfunction monitorXhr(this: BrowserClient, notify: (eventName: BrowserEventTypes, data: any) => void) {\n  const { options, transport } = this\n  if (!('XMLHttpRequest' in _global)) {\n    return\n  }\n  const originalXhrProto = XMLHttpRequest.prototype\n  replaceOld(originalXhrProto, 'open', (originalOpen: voidFun): voidFun => {\n    return function (this: MITOXMLHttpRequest, ...args: any[]): void {\n      this.httpCollect = {\n        request: {\n          httpType: HttpTypes.XHR,\n          method: variableTypeDetection.isString(args[0]) ? args[0].toUpperCase() : args[0],\n          url: args[1]\n        },\n        response: {},\n        time: getTimestamp()\n      }\n      originalOpen.apply(this, args)\n    }\n  })\n  replaceOld(originalXhrProto, 'send', (originalSend: voidFun): voidFun => {\n    return function (this: MITOXMLHttpRequest, ...args: any[]): void {\n      const { request } = this.httpCollect\n      const { method, url } = request\n      options.setTraceId(url, (headerFieldName: string, traceId: string) => {\n        request.traceId = traceId\n        this.setRequestHeader(headerFieldName, traceId)\n      })\n      options.beforeAppAjaxSend && options.beforeAppAjaxSend({ method, url }, this)\n      on(this, 'loadend', function (this: MITOXMLHttpRequest) {\n        const isBlock = transport.isSelfDsn(url) || options.isFilterHttpUrl(url)\n        if (isBlock) return\n        const { responseType, response, status } = this\n        request.data = args[0]\n        const eTime = getTimestamp()\n        if (['', 'json', 'text'].indexOf(responseType) !== -1) {\n          this.httpCollect.response.data = typeof response === 'object' ? JSON.stringify(response) : response\n        }\n        this.httpCollect.response.status = status\n        this.httpCollect.elapsedTime = eTime - this.httpCollect.time\n        notify(BrowserEventTypes.XHR, this.httpCollect)\n      })\n      originalSend.apply(this, args)\n    }\n  })\n}\n\nexport function httpTransform(httpCollectedData: HttpCollectedType): HttpTransformedType {\n  let message = ''\n  const {\n    request: { httpType, method, url },\n    response: { status },\n    elapsedTime\n  } = httpCollectedData\n  const name = `${httpType}--${method}`\n  if (status === 0) {\n    message =\n      elapsedTime <= globalVar.crossOriginThreshold ? 'http请求失败，失败原因：跨域限制或域名不存在' : 'http请求失败，失败原因：超时'\n  } else {\n    message = fromHttpStatus(status)\n  }\n  message = message === SpanStatus.Ok ? message : `${message} ${getRealPath(url)}`\n  return {\n    ...httpCollectedData,\n    type: ErrorTypes.HTTP,\n    url: getLocationHref(),\n    level: Severity.Low,\n    message,\n    name\n  }\n}\n\nexport function httpTransformedDataConsumer(this: BrowserClient, transformedData: HttpTransformedType) {\n  const type = transformedData.request.httpType === HttpTypes.FETCH ? BrowserBreadcrumbTypes.FETCH : BrowserBreadcrumbTypes.XHR\n  // time 是为了保持顺序，紧跟在点击事件后面\n  const {\n    response: { status },\n    time\n  } = transformedData\n  const isError = status === 0 || status === HTTP_CODE.BAD_REQUEST || status > HTTP_CODE.UNAUTHORIZED\n  addBreadcrumbInBrowser.call(this, transformedData, type, Severity.Info, { time })\n  if (isError) {\n    const breadcrumStack = this.breadcrumb.push({\n      type,\n      category: BREADCRUMBCATEGORYS.EXCEPTION,\n      data: transformedData,\n      level: Severity.Error,\n      time\n    })\n    this.transport.send(transformedData, breadcrumStack)\n  }\n}\n\nexport default xhrPlugin\n","import { BrowserEventTypes, HttpTypes } from '@mitojs/shared'\nimport { getTimestamp, replaceOld, _global } from '@mitojs/utils'\nimport { BasePluginType, HttpCollectedType, HttpTransformedType, voidFun } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { httpTransform, httpTransformedDataConsumer } from './xhr'\n\nconst fetchPlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.FETCH,\n  monitor(notify) {\n    monitorFetch.call(this, notify)\n  },\n  transform(collectedData: HttpCollectedType) {\n    return httpTransform(collectedData)\n  },\n  consumer(transformedData: HttpTransformedType) {\n    httpTransformedDataConsumer.call(this, transformedData)\n  }\n}\n\nfunction monitorFetch(this: BrowserClient, notify: (eventName: BrowserEventTypes, data: any) => void) {\n  const { options, transport } = this\n  if (!('fetch' in _global)) {\n    return\n  }\n  replaceOld(_global, BrowserEventTypes.FETCH, (originalFetch: voidFun) => {\n    return function (url: string, config: Partial<Request> = {}): void {\n      const sTime = getTimestamp()\n      const method = (config && config.method) || 'GET'\n      const httpCollect: HttpCollectedType = {\n        request: {\n          httpType: HttpTypes.FETCH,\n          url,\n          method,\n          data: config && config.body\n        },\n        time: sTime,\n        response: {}\n      }\n      const headers = new Headers(config.headers || {})\n      Object.assign(headers, {\n        setRequestHeader: headers.set\n      })\n      options.setTraceId(url, (headerFieldName: string, traceId: string) => {\n        httpCollect.request.traceId = traceId\n        headers.set(headerFieldName, traceId)\n      })\n      options.beforeAppAjaxSend && options.beforeAppAjaxSend({ method, url }, headers)\n      config = {\n        ...config,\n        headers\n      }\n      const isBlock = transport.isSelfDsn(url) || options.isFilterHttpUrl(url)\n      return originalFetch.apply(_global, [url, config]).then(\n        (res: Response) => {\n          const resClone = res.clone()\n          const eTime = getTimestamp()\n          httpCollect.elapsedTime = eTime - sTime\n          httpCollect.response.status = resClone.status\n          resClone.text().then((data) => {\n            if (isBlock) return\n            httpCollect.response.data = data\n            notify(BrowserEventTypes.FETCH, httpCollect)\n          })\n          return res\n        },\n        (err: Error) => {\n          if (isBlock) return\n          const eTime = getTimestamp()\n          httpCollect.elapsedTime = eTime - sTime\n          httpCollect.response.status = 0\n          notify(BrowserEventTypes.FETCH, httpCollect)\n          throw err\n        }\n      )\n    }\n  })\n}\n\nexport default fetchPlugin\n","import { BrowserBreadcrumbTypes, BrowserEventTypes } from '@mitojs/shared'\nimport { htmlElementAsString, on, throttle, _global } from '@mitojs/utils'\nimport { BasePluginType } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\n\nexport interface DomCollectedType {\n  // maybe will add doubleClick or other in the future\n  category: 'click'\n  data: Document\n}\nconst domPlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.DOM,\n  monitor(notify) {\n    if (!('document' in _global)) return\n    const clickThrottle = throttle(notify, this.options.throttleDelayTime)\n    on(\n      _global.document,\n      'click',\n      function () {\n        clickThrottle(BrowserEventTypes.DOM, {\n          category: 'click',\n          data: this\n        })\n      },\n      true\n    )\n  },\n  transform(collectedData: DomCollectedType) {\n    const htmlString = htmlElementAsString(collectedData.data.activeElement as HTMLElement)\n    return htmlString\n  },\n  consumer(transformedData: string) {\n    if (transformedData) {\n      addBreadcrumbInBrowser.call(this, transformedData, BrowserBreadcrumbTypes.CLICK)\n    }\n  }\n}\n\nexport default domPlugin\n","import { BrowserBreadcrumbTypes, BrowserEventTypes, ErrorTypes, ERROR_TYPE_RE } from '@mitojs/shared'\nimport { extractErrorStack, getLocationHref, getTimestamp, interceptStr, isError, on, Severity, _global } from '@mitojs/utils'\nimport { BasePluginType, ReportDataType } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\n\nexport interface ResourceErrorTarget {\n  src?: string\n  href?: string\n  localName?: string\n}\n\nconst errorPlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.ERROR,\n  monitor(notify) {\n    on(\n      _global,\n      'error',\n      function (e: ErrorEvent) {\n        notify(BrowserEventTypes.ERROR, e)\n      },\n      true\n    )\n  },\n  transform(errorEvent: ErrorEvent) {\n    const target = errorEvent.target as ResourceErrorTarget\n    if (target.localName) {\n      // resource error\n      return resourceTransform(errorEvent.target as ResourceErrorTarget)\n    }\n    // code error\n    return codeErrorTransform(errorEvent)\n  },\n  consumer(transformedData: ReportDataType) {\n    const type = transformedData.type === ErrorTypes.RESOURCE ? BrowserBreadcrumbTypes.RESOURCE : BrowserBreadcrumbTypes.CODE_ERROR\n    const breadcrumbStack = addBreadcrumbInBrowser.call(this, transformedData, type, Severity.Error)\n    this.transport.send(transformedData, breadcrumbStack)\n  }\n}\n\nconst resourceMap = {\n  img: '图片',\n  script: 'JS脚本'\n}\n\nfunction resourceTransform(target: ResourceErrorTarget) {\n  return {\n    type: ErrorTypes.RESOURCE,\n    url: getLocationHref(),\n    message: '资源地址: ' + (interceptStr(target.src, 120) || interceptStr(target.href, 120)),\n    level: Severity.Low,\n    time: getTimestamp(),\n    name: `${resourceMap[target.localName] || target.localName}加载失败`\n  }\n}\n\nfunction codeErrorTransform(errorEvent: ErrorEvent) {\n  const { message, filename, lineno, colno, error } = errorEvent\n  let result: ReportDataType\n  if (error && isError(error)) {\n    result = extractErrorStack(error, Severity.Normal)\n  }\n  result || (result = handleNotErrorInstance(message, filename, lineno, colno))\n  result.type = ErrorTypes.JAVASCRIPT\n  return result\n}\n\nfunction handleNotErrorInstance(message: string, filename: string, lineno: number, colno: number) {\n  let name: string | ErrorTypes = ErrorTypes.UNKNOWN\n  const url = filename || getLocationHref()\n  let msg = message\n  const matches = message.match(ERROR_TYPE_RE)\n  if (matches[1]) {\n    name = matches[1]\n    msg = matches[2]\n  }\n  const element = {\n    url,\n    func: ErrorTypes.UNKNOWN_FUNCTION,\n    args: ErrorTypes.UNKNOWN,\n    line: lineno,\n    col: colno\n  }\n  return {\n    url,\n    name,\n    message: msg,\n    level: Severity.Normal,\n    time: getTimestamp(),\n    stack: [element]\n  }\n}\nexport default errorPlugin\n","import { BrowserBreadcrumbTypes, BrowserEventTypes } from '@mitojs/shared'\nimport { isExistProperty, on, parseUrlToObj, _global } from '@mitojs/utils'\nimport { BasePluginType, RouteChangeCollectType } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\n\nconst hashRoutePlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.HASHCHANGE,\n  monitor(notify) {\n    if (!isExistProperty(_global, 'onpopstate')) {\n      on(_global, BrowserEventTypes.HASHCHANGE, function (e: HashChangeEvent) {\n        const { oldURL: from, newURL: to } = e\n        notify(BrowserEventTypes.HASHCHANGE, { from, to })\n      })\n    }\n  },\n  transform(collectedData: RouteChangeCollectType) {\n    return routeTransform(collectedData)\n  },\n  consumer(transformedData: RouteChangeCollectType) {\n    routeTransformedConsumer.call(this, transformedData)\n  }\n}\n\nexport function routeTransform(collectedData: RouteChangeCollectType): RouteChangeCollectType {\n  const { from, to } = collectedData\n  const { relative: parsedFrom } = parseUrlToObj(from)\n  const { relative: parsedTo } = parseUrlToObj(to)\n  return {\n    from: parsedFrom ? parsedFrom : '/',\n    to: parsedTo ? parsedTo : '/'\n  }\n}\n\nexport function routeTransformedConsumer(this: BrowserClient, transformedData: RouteChangeCollectType) {\n  if (transformedData.from === transformedData.to) return\n  addBreadcrumbInBrowser.call(this, transformedData, BrowserBreadcrumbTypes.ROUTE)\n}\n\nexport default hashRoutePlugin\n","import { BrowserEventTypes } from '@mitojs/shared'\nimport { getLocationHref, replaceOld, supportsHistory, _global } from '@mitojs/utils'\nimport { BasePluginType, RouteChangeCollectType, voidFun } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { routeTransform, routeTransformedConsumer } from './hashRoute'\n\nconst historyRoutePlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.HISTORY,\n  monitor(notify) {\n    let lastHref: string\n    if (!supportsHistory()) return\n    const oldOnpopstate = _global.onpopstate\n    _global.onpopstate = function (this: WindowEventHandlers, ...args: any[]): any {\n      const to = getLocationHref()\n      const from = lastHref\n      lastHref = to\n      notify(BrowserEventTypes.HISTORY, {\n        from,\n        to\n      })\n      oldOnpopstate && oldOnpopstate.apply(this, args)\n    }\n    function historyReplaceFn(originalHistoryFn: voidFun): voidFun {\n      return function (this: History, ...args: any[]): void {\n        const url = args.length > 2 ? args[2] : undefined\n        if (url) {\n          const from = lastHref\n          const to = String(url)\n          lastHref = to\n          notify(BrowserEventTypes.HISTORY, {\n            from,\n            to\n          })\n        }\n        return originalHistoryFn.apply(this, args)\n      }\n    }\n    // 以下两个事件是人为调用，但是不触发onpopstate\n    replaceOld(_global.history, 'pushState', historyReplaceFn)\n    replaceOld(_global.history, 'replaceState', historyReplaceFn)\n  },\n  transform(collectedData: RouteChangeCollectType) {\n    return routeTransform(collectedData)\n  },\n  consumer(transformedData: RouteChangeCollectType) {\n    routeTransformedConsumer.call(this, transformedData)\n  }\n}\n\nexport default historyRoutePlugin\n","import { BrowserBreadcrumbTypes, BrowserEventTypes, globalVar } from '@mitojs/shared'\nimport { replaceOld, Severity, _global } from '@mitojs/utils'\nimport { BasePluginType, ConsoleCollectType } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\nconst consolePlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name: BrowserEventTypes.CONSOLE,\n  monitor(notify) {\n    if (!('console' in _global)) {\n      return\n    }\n    const logType = ['log', 'debug', 'info', 'warn', 'error', 'assert']\n    logType.forEach(function (level: string): void {\n      if (!(level in _global.console)) return\n      replaceOld(_global.console, level, function (originalConsole: () => any): Function {\n        return function (...args: any[]): void {\n          if (originalConsole) {\n            notify(BrowserEventTypes.CONSOLE, { args, level })\n            originalConsole.apply(_global.console, args)\n          }\n        }\n      })\n    })\n  },\n  transform(collectedData: ConsoleCollectType) {\n    return collectedData\n  },\n  consumer(transformedData: ConsoleCollectType) {\n    if (globalVar.isLogAddBreadcrumb) {\n      addBreadcrumbInBrowser.call(this, transformedData, BrowserBreadcrumbTypes.CONSOLE, Severity.fromString(transformedData.level))\n    }\n  }\n}\n\nexport default consolePlugin\n","import { BrowserBreadcrumbTypes, BrowserEventTypes, ErrorTypes } from '@mitojs/shared'\nimport { extractErrorStack, getLocationHref, getTimestamp, isError, on, Severity, unknownToString, _global } from '@mitojs/utils'\nimport { BasePluginType, HttpTransformedType, ReportDataType } from '@mitojs/types'\nimport { BrowserClient } from '../browserClient'\nimport { addBreadcrumbInBrowser } from '../utils'\n\nconst name = BrowserEventTypes.UNHANDLEDREJECTION\nconst unhandlerejectionPlugin: BasePluginType<BrowserEventTypes, BrowserClient> = {\n  name,\n  monitor(notify) {\n    on(_global, name, function (ev: PromiseRejectionEvent) {\n      // ev.preventDefault() 阻止默认行为后，控制台就不会再报红色错误\n      notify(name, ev)\n    })\n  },\n  transform(collectedData: PromiseRejectionEvent) {\n    console.log('collectedData', collectedData)\n    let data: ReportDataType = {\n      type: ErrorTypes.PROMISE,\n      message: unknownToString(collectedData.reason),\n      url: getLocationHref(),\n      name: collectedData.type,\n      time: getTimestamp(),\n      level: Severity.Low\n    }\n    if (isError(collectedData.reason)) {\n      data = {\n        ...data,\n        ...extractErrorStack(collectedData.reason, Severity.Low)\n      }\n    }\n    return data\n  },\n  consumer(transformedData: HttpTransformedType) {\n    const breadcrumbStack = addBreadcrumbInBrowser.call(this, transformedData, BrowserBreadcrumbTypes.UNHANDLEDREJECTION, Severity.Error)\n    this.transport.send(transformedData, breadcrumbStack)\n  }\n}\n\nexport default unhandlerejectionPlugin\n","export * from './types'\nimport { BrowserClient } from './browserClient'\nimport { BrowserOptionsFieldsTypes } from './types'\nimport fetchPlugin from './plugins/fetch'\nimport xhrPlugin from './plugins/xhr'\nimport domPlugin from './plugins/dom'\nimport errorPlugin from './plugins/error'\nimport hashRoutePlugin from './plugins/hashRoute'\nimport historyRoutePlugin from './plugins/historyRoute'\nimport consolePlugin from './plugins/console'\nimport unhandlerejectionPlugin from './plugins/unhandlerejecttion'\nimport { BasePluginType } from '@mitojs/types'\nfunction createBrowserInstance(options: BrowserOptionsFieldsTypes = {}, plugins: BasePluginType[] = []) {\n  const browserClient = new BrowserClient(options)\n  const browserPlugins = [\n    fetchPlugin,\n    xhrPlugin,\n    domPlugin,\n    errorPlugin,\n    hashRoutePlugin,\n    historyRoutePlugin,\n    consolePlugin,\n    unhandlerejectionPlugin\n  ]\n  browserClient.use([...browserPlugins, ...plugins])\n  return browserClient\n}\n\nconst init = createBrowserInstance\nexport { createBrowserInstance, init, BrowserClient }\n"],"names":[],"mappings":"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"}